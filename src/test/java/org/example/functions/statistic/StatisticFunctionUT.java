package org.example.functions.statistic;

import DeplacementPresidentFunction.Parser.DeplacementPresidentStatFunction;
import org.apache.spark.sql.Dataset;
import org.apache.spark.sql.Encoders;
import org.apache.spark.sql.SparkSession;
import beans.DeplacementPresident;
import org.junit.Test;


import java.util.List;

import static org.assertj.core.api.Java6Assertions.assertThat;

public class StatisticFunctionUT {

    @Test

    public void testStatistic(){

        SparkSession sparkSession =  SparkSession.builder()
                .master("local[2]")
                .appName("testStatistic")
                .getOrCreate();
        DeplacementPresidentStatFunction y = new DeplacementPresidentStatFunction();
        Dataset<DeplacementPresident> yl = sparkSession.createDataset(
                List.of( DeplacementPresident.builder()
                                .contours("churchill")
                                .fonction("data_analyst")
                                .personne("yan")
                                        .build()),
                Encoders.bean(DeplacementPresident.class)
        );

        Long expected = 1L;
        Long actual = y.apply(yl);

        assertThat(actual).isEqualTo(expected);


    }
}
