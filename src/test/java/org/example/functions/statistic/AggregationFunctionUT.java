package org.example.functions.statistic;

import DeplacementPresidentFunction.DeplacementPresidentAgregation;
import DeplacementPresidentFunction.DeplacementPresidentStatFunction;
import org.apache.spark.sql.Dataset;
import org.apache.spark.sql.Encoders;
import org.apache.spark.sql.Row;
import org.apache.spark.sql.SparkSession;
import org.example.DeplacementPresident;
import org.junit.Test;

import java.util.List;

import static org.assertj.core.api.Java6Assertions.assertThat;

public class AggregationFunctionUT {
    @Test

    public void testAggregation(){

        SparkSession sparkSession =  SparkSession.builder()
                .master("local[2]")
                .appName("testAggregation")
                .getOrCreate();
        DeplacementPresidentAgregation ds = new DeplacementPresidentAgregation();
        Dataset<DeplacementPresident> dss = sparkSession.createDataset(
                List.of( DeplacementPresident.builder()
                        .contours("churchill")
                        .fonction("data_analyst")
                        .personne("yan")
                        .build()),
                Encoders.bean(DeplacementPresident.class)
        );

       // Dataset<Row> = expected = 1L;
        //Dataset<Row> = ds.apply(dss);

        //assertThat(actual).isEqualTo(expected);



    }
}
