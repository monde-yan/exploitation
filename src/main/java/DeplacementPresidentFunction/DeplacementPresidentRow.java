package DeplacementPresidentFunction;

import org.example.DeplacementPresident;
import org.apache.spark.sql.Row;

import java.io.Serializable;
import java.util.function.Function;

public class DeplacementPresidentRow implements Function<Row, DeplacementPresident> , Serializable {
    @Override
    public DeplacementPresident apply(Row row) {
        String FONCTION = row.getAs("fonction");
        String PERSONNE = row.getAs("personne");
        String CONTENU = row.getAs("contenu");
        String LIEU_NIVEAU_1 = row.getAs("lieu_niveau_1");
        String LIEU_NIVEAU_2 = row.getAs("lieu_niveau_2");
        String LIEU_NIVEAU_3 = row.getAs("lieu_niveau_3");
        String DATE_DEBUT = row.getAs("date_debut");
        String DATE_FIN = row.getAs("date_fin");
        String CONTOURS = row.getAs("contours");
        String URL = row.getAs("url");
        String COTE = row.getAs("cote");
        String GEO_POINT_2D = row.getAs("geo_point_2d");




        return DeplacementPresident.builder()
                .fonction(FONCTION)
                .personne(PERSONNE)
                .contenu(CONTENU)
                .lieu_niveau_1(LIEU_NIVEAU_1)
                .lieu_niveau_2(LIEU_NIVEAU_2)
                .lieu_niveau_3(LIEU_NIVEAU_3)
                .date_debut(DATE_DEBUT)
                .date_fin(DATE_FIN)
                .contours(CONTOURS)
                .url(URL)
                .cote(COTE)
                .geo_point_2d(GEO_POINT_2D)
                .build();
    }
}
